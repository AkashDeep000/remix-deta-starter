name: learn-github-actions
on: [push]
jobs:
  runs-on: ubuntu-latest
    runs:
    steps:
      using: "composite"
      steps:
        - uses: actions/checkout@v3
        - uses: actions/setup-node@v3
          with:
            node-version: '14'
            deta-access-token: 'ViJbaJGb_Rcth73b2H7M6fEjWuEbhseuCcGd8HAaa' #Deta access token https://docs.deta.sh/docs/cli/auth
            deta-name: 'remix-deta'
            deta-project: 'default'
            deta-project-dir: '.'
          - run: npm install
          - name: Install Deta CLI
            shell: bash
            run: |
              curl -fsSL https://get.deta.dev/cli.sh | sh

           - name: Clone Deta Metadata
            shell: bash
            run: |
              export DETA_ACCESS_TOKEN=${{ inputs.deta-access-token }}
              cd ${{ inputs.deta-project-dir }}
              ~/.deta/bin/deta clone --name ${{ inputs.deta-name }} --project ${{ inputs.deta-project }} tmp/
              cp -r tmp/.deta .

          - name: Deploy to Deta
            shell: bash
            run: |
              export DETA_ACCESS_TOKEN=${{ inputs.deta-access-token }}
              cd ${{ inputs.deta-project-dir }}
              ~/.deta/bin/deta deploy
branding:
  icon: check-circle
  color: purple